ParseDec â† {+Â´('0'-Ëœğ•©)Ã—(âŒ½10â‹†â†•â‰ ğ•©)}
Split â† {ğ•¨((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢)ğ•©}
CutAt â† { at â† ğ•© â‹„ âŸ¨âŸ© {atâ‰¡âŠ‘ğ•©?ğ•¨â€¿(1â†“ğ•©);((ğ•¨âˆ¾âŠğ•©)ğ•Š(1â†“ğ•©))} ğ•¨ }
data â† â€¢file.Lines "day13.dat2"
mapâ€¿folds â† data CutAt ""
map â†© >ParseDecÂ¨Â¨','SplitÂ¨map
folds â†© {dimâ€¿v â† '='Splitğ•© â‹„ (âŠ‘dim-'x')â€¿(ParseDec v)}Â¨(11â†“Â¨folds)

RenderMap â† { ğ•Š map:
  xâ€¿y â† {â†•1+âŒˆÂ´ğ•©âŠË˜map}Â¨0â€¿1
  {âˆ¾{pâ†ğ•©, âˆ¨Â´{pâ‰¡ğ•©}â‰1 map?"â€¢";" "}Â¨ğ•©}â‰1 â‰xâ‹ˆâŒœy
}
Fold â† { map ğ•Š dirâ€¿k:
  keepâ€¿over â† ({dirâŠ‘ğ•©>k}Ë˜map)âŠ”map
  keepâˆ¾{((2Ã—k)-dirâŠ‘ğ•©)âŒ¾(dirâŠ¸âŠ‘)ğ•©}Ë˜over
}

p1 â† +Â´âˆŠmap Fold (âŠ‘folds)
p2 â† RenderMap (map FoldËœÂ´ âŒ½folds)
